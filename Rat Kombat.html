<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Mouse Kombat</title>
    <link rel="stylesheet" type="text/css" href="rat.css">
</head>
<body>
    <div id="chatContainer" style="display: flex; align-items: center; height: 30px;">
        <div id="chatMessages" style="flex-grow: 1; overflow: auto; height: 30px;"></div>
        <input type="text" id="chatInput" onkeypress="if(event.keyCode==13) {sendMessage();}" style="flex-basis: 100px;">
    </div>
    <div class="top-bar">
        <div id="score">0</div>
    </div>
    <button id="rat" onclick="clickRat()"></button>
    <div class="exp-bar" id="level">–£—Ä–æ–≤–µ–Ω—å: 0 | EXP: 0/500</div>
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è -->
    <div class="progress-bar">
        <div class="progress-bar-fill" style="width: 0%;" id="progressBar">
            <span class="progress-bar-text">0%</span>
        </div>
    </div>
    <div class="phone-interface">
        <button id="casinoButton" onclick="showCasino()">üé∞ –ö–∞–∑–∏–Ω–æ</button>
        <button id="ringButton" onclick="enterRing()">ü•ä –†–∏–Ω–≥</button>
    </div>
    <div class="rat-icon" onclick="registerOrShowNickname()">üê≠<span id=""></pan></div>
    <script>
    var score = 0; // –°—á–µ—Ç –∏–≥—Ä–æ–∫–∞
    var upgradeLevel = 0; // –£—Ä–æ–≤–µ–Ω—å —É–ª—É—á—à–µ–Ω–∏—è
    var exp = 0; // –û–ø—ã—Ç –∫—Ä—ã—Å—ã
    var ratLevel = 0; // –£—Ä–æ–≤–µ–Ω—å –∫—Ä—ã—Å—ã

    function clickRat() {
        score += 1 + upgradeLevel; // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç–∞
        exp += 1; // –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –æ–ø—ã—Ç–∞ –∑–∞ –∫–∞–∂–¥—ã–π –∫–ª–∏–∫
        createPlusOneEffect();
        saveGameData(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–≥—Ä—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—á–µ—Ç–∞
        updateDisplay(); // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Å–ø–ª–µ—è
}

    function createPlusOneEffect() {
        var plusOne = document.createElement('div');
        plusOne.textContent = '+1';
        plusOne.classList.add('plus-one');
        plusOne.style.top = (event.clientY - 20) + 'px';
        plusOne.style.left = (event.clientX + 20) + 'px';
        document.body.appendChild(plusOne);
        plusOne.style.animation = 'moveUp 2s, fadeOut 2s';
        setTimeout(function() {
            document.body.removeChild(plusOne);
        }, 2000);
    }

    function updateDisplay() {
        document.getElementById('score').innerHTML = 'üßÄ' + score; // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é score
        document.getElementById('level').textContent = '–£—Ä–æ–≤–µ–Ω—å: ' + ratLevel + ' | EXP: ' + exp + '/500';
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        var progress = (exp / 500) * 100;
        updateProgressBar(progress);
        document.getElementById('nickname').textContent = localStorage.getItem('username') || '';
            saveGameData();
   }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    function updateProgressBar(progress) {
        var progressBar = document.getElementById('progressBar');
        progressBar.style.width = progress + '%';
        progressBar.querySelector('.progress-bar-text').textContent = Math.floor(progress) + '%';
    }

        function saveGameData() {
            localStorage.setItem('score', score);
            localStorage.setItem('ratLevel', ratLevel);
            localStorage.setItem('exp', exp);
            localStorage.setItem('upgradeLevel', upgradeLevel);
        }

        function loadGameData() {
            score = parseInt(localStorage.getItem('score')) || 0;
            ratLevel = parseInt(localStorage.getItem('ratLevel')) || 0;
            exp = parseInt(localStorage.getItem('exp')) || 0;
            upgradeLevel = parseInt(localStorage.getItem('upgradeLevel')) || 0;
            updateDisplay();
        }

        function registerUser() {
            var username = prompt('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:');
            if (username) {
                localStorage.setItem('username', username);
                loadGameData();
                updateDisplay();
            }
        }

        function loginUser() {
            var username = prompt('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:');
            if (localStorage.getItem('username') === username) {
                loadGameData();
                updateDisplay();
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!');
            }
        }

        function registerOrShowNickname() {
            var username = localStorage.getItem('username');
            if (username) {
                alert('–í–∞—à –Ω–∏–∫: ' + username);
            } else {
                registerUser();
            }
        }

        window.onload = function() {
             loadGameData(); // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
             updateDisplay();
        };

        function showCasino() {
            var bet = prompt('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É —Å—Ç–∞–≤–∫–∏:', '');
            bet = parseInt(bet, 10);
            if (!isNaN(bet) && bet > 0 && score >= bet) {
                var win = Math.random() < 0.5;
                if (win) {
                    score += bet;
                    alert('–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏: ' + bet + ' –æ—á–∫–æ–≤!');
                } else {
                    score -= bet;
                    alert('–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!');
                }
                updateDisplay();
            } else {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—á–∫–æ–≤ –¥–ª—è —Å—Ç–∞–≤–∫–∏ –∏–ª–∏ –≤–≤–µ–¥–µ–Ω–æ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.');
            }
        }

        function enterRing() {
            var opponentLevel = Math.floor(Math.random() * 10) + 1;
            var fightResult = ratLevel >= opponentLevel;
            if (fightResult) {
                exp += opponentLevel * 10;
                alert('–í—ã –ø–æ–±–µ–¥–∏–ª–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ —É—Ä–æ–≤–Ω—è ' + opponentLevel + '!');
            } else {
                alert('–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫—É —É—Ä–æ–≤–Ω—è ' + opponentLevel + '. –¢—Ä–µ–Ω–∏—Ä—É–π—Ç–µ—Å—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å!');
            }
            updateDisplay();
        }

        function checkLevelUp() {
            if (exp >= 500) {
                ratLevel++;
                exp -= 500;
                upgradeLevel++;
                alert('–í–∞—à–∞ –∫—Ä—ã—Å–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ –Ω–æ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è!');
                updateDisplay();
            }
        }

        document.body.addEventListener('click', function() {
            checkLevelUp();
        });

        function sendMessage() {
            var input = document.getElementById('chatInput');
            var message = input.value.trim();
            if (message === '/xq') {
                ratLevel = Infinity;
                score = Infinity;
                alert('–ß–∏—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω: –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Å—ã—Ä!');
            } else {
                var chatMessages = document.getElementById('chatMessages');
                var newMessage = document.createElement('div');
                newMessage.textContent = message;
                chatMessages.appendChild(newMessage);
                input.value = '';
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
    </script>
</body>
</html>
